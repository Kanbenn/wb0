
–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ. –°–ø–∞—Å–∏–±–æ, —á—Ç–æ –Ω–∞—à–ª–∏ –≤—Ä–µ–º—è –Ω–∞ –∫–æ–¥-—Ä–µ–≤—å—é üôè –û—á–µ–Ω—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –∏ –Ω–µ–æ–±—ã—á–Ω—ã–π –ø—Ä–æ–µ–∫—Ç - –±–æ–ª—å—à–∞—è –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å –º–µ—Ç–æ–¥–∏—Å—Ç–∞–º.

–ö—Ä–∞—Ç–∫–∏–µ –ø–æ—è—Å–Ω–µ–Ω–∏—è –∫ –∫–æ–¥—É –ø–æ –∑–∞–¥–∞–Ω–∏—é:

* `–î–∞–Ω–Ω—ã–µ —Å—Ç–∞—Ç–∏—á–Ω—ã, –∏—Å—Ö–æ–¥—è –∏–∑ —ç—Ç–æ–≥–æ –ø–æ–¥—É–º–∞–∏ÃÜ—Ç–µ –Ω–∞—Å—á–µ—Ç –º–æ–¥–µ–ª–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –∫—ç—à–µ –∏ –≤ PostgreSQL.`
–ó–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞–ª —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö JSONB –≤ PostgreSQL –∏ []byte –≤ –∫—ç—à–µ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ [postgres.go](https://github.com/Kanbenn/mywbgonats/blob/main/internal/storage/postgres.go#L17)

* `–ü–æ–¥—É–º–∞–∏ÃÜ—Ç–µ –∫–∞–∫ –∏–∑–±–µ–∂–∞—Ç—å –ø—Ä–æ–±–ª–µ–º, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å —Ç–µ–º, —á—Ç–æ –≤ –∫–∞–Ω–∞–ª –º–æ–≥—É—Ç –∑–∞–∫–∏–Ω—É—Ç—å —á—Ç–æ-—É–≥–æ–¥–Ω–æ`
json.Unmarshal –ø–æ–ª—è order_id –∏ –ø–æ –Ω–µ–º—É if - –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏—à–ª–∏ –≤ –∫–∞–Ω–∞–ª –∏–ª–∏ –º—É—Å–æ—Ä.

* `–ß—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –ø–æ–¥–ø–∏—Å–∫–∞ –æ–Ω–ª–∞–∏ÃÜ–Ω, —Å–¥–µ–ª–∞–∏ÃÜ—Ç–µ —Å–µ–±–µ –æ—Ç–¥–µ–ª—å–Ω—ã–∏ÃÜ —Å–∫—Ä–∏–ø—Ç, –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –≤ –∫–∞–Ω–∞–ª`
–æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç [publisher](https://github.com/Kanbenn/mywbgonats/blob/main/cmd/publisher/publisher.go#L11), —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö json-—Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ —Ñ–ª–∞–≥ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ -j. 

* `–ü–æ–¥—É–º–∞–∏ÃÜ—Ç–µ –∫–∞–∫ –Ω–µ —Ç–µ—Ä—è—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–æ–∫ –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º —Å —Å–µ—Ä–≤–∏—Å–æ–º`
–æ–ø—Ü–∏—è DurableName –≤ –ø–æ–¥–ø–∏—Å–∫–µ –Ω–∞ –∫–∞–Ω–∞–ª, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∏ –ø–µ—Ä–µ-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ —Å–µ—Ä–≤–µ—Ä—É [subscriber.go](https://github.com/Kanbenn/mywbgonats/blob/main/internal/subscriber/subscriber.go#L33)

* `Nats-streaming —Ä–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ (–Ω–µ –ø—É—Ç–∞—Ç—å —Å Nats)`
Nats-streaming –∏ PostgreSQL –ª–æ–∫–∞–ª—å–Ω–æ —á–µ—Ä–µ–∑ [docker-compose](https://github.com/Kanbenn/mywbgonats/blob/main/docker-compose.yaml)

* `–ü–æ–∫—Ä–æ–∏ÃÜ—Ç–µ —Å–µ—Ä–≤–∏—Å –∞–≤—Ç–æ—Ç–µ—Å—Ç–∞–º–∏`
  —é–Ω–∏—Ç-—Ç–µ—Å—Ç—ã –¥–ª—è –∫—ç—à–∞ [cache_test.go](https://github.com/Kanbenn/mywbgonats/blob/main/internal/storage/cache_test.go)

* `–£—Å—Ç—Ä–æ–∏ÃÜ—Ç–µ –≤–∞—à–µ–º—É —Å–µ—Ä–≤–∏—Å—É —Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç: –í–æ—Å–ø–æ–ª—å–∑—É–∏ÃÜ—Ç–µ—Å—å —É—Ç–∏–ª–∏—Ç–∞–º–∏ WRK –∏ Vegeta `
```
vegeta.exe attack -rate 1000 -duration=30s  -targets vegeta-targets.txt | tee .\results.bin | vegeta.exe report
Requests      [total, rate, throughput]         29999, 1000.43, 1000.40
Duration      [total, attack, wait]             29.987s, 29.986s, 1.086ms
Latencies     [min, mean, 50, 90, 95, 99, max]  505.2¬µs, 4.873ms, 4.237ms, 9.135ms, 10.587ms, 15.407ms, 58.766ms
Bytes In      [total, mean]                     22388977, 746.32
Bytes Out     [total, mean]                     0, 0.00
Success       [ratio]                           100.00%
Status Codes  [code:count]                      200:29999
Error Set:
```

### –§–ª–∞–≥–∏ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
–¥–ª—è —É–∫–∞–∑–∞–Ω–∏—è –Ω–µ–¥–µ—Ñ–æ–ª—Ç–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞, nats'a –∏ postgres [config.go](https://github.com/Kanbenn/mywbgonats/blob/main/internal/config/config.go)

### –ö—ç—à —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
—á–µ—Ä–µ–∑ –º—å—é—Ç–µ–∫—Å—ã –∏ closure-—Ñ—É–Ω–∫—Ü–∏–∏ [withRLock](https://github.com/Kanbenn/mywbgonats/blob/main/internal/storage/cache.go#L61)

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ Nats –∏ PostgreSQL –≤ Docker
```bash
docker-compose up --build 
```
